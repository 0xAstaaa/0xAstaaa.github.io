---
title: "EpicSales CTF — Full Writeup"
date: 2025-10-28
categories:
  - ctftime
tags:
  - sql
---

# EpicSales CTF — Full Writeup (All Phases)

This document summarizes the solutions for the EpicSales CTF challenges and lists the discovered flags at the end. Each phase includes the approach and the exact SQL used to extract the flag.

---

## Phase 1 — New Customer Signups After 2025-09-01

**Objective:** Count customers who signed up on or after September 1, 2025.

**Key table/column:** `customers.join_date`

**SQL:**
```sql
SELECT CONCAT('deadface{', COUNT(*), '}') 
FROM customers 
WHERE join_date >= '2025-09-01';
```

**Flag:** `deadface{18}`

---

## Phase 2 — Product with Highest Average Rating

**Objective:** Identify the product with the highest average rating.

**Key tables/columns:** `reviews(product_id,rating)`, `products(product_id,product_name)`

**SQL:**
```sql
SELECT CONCAT('deadface{', p.product_name, '}') AS flag
FROM products p
JOIN reviews r ON p.product_id = r.product_id
GROUP BY p.product_id, p.product_name
ORDER BY AVG(r.rating) DESC
LIMIT 1;
```

**Flag:** `deadface{VortexAudio Focus}`

---

## Phase 3 — Low Inventory by Facility

**Objective:** Find products where the total quantity in a facility is less than 5 and return the product name and facility number; then pick the product with the lowest quantity.

**Key tables/columns:** `inventories(product_id, facility_id, quantity)`, `products(product_id,product_name)`, `facilities(facility_id,facility_num)`

**SQL:**
```sql
SELECT CONCAT('deadface{', p.product_name, ' ', f.facility_num, '}') AS flag
FROM inventories i
JOIN products p ON i.product_id = p.product_id
JOIN facilities f ON i.facility_id = f.facility_id
GROUP BY i.product_id, i.facility_id
HAVING SUM(i.quantity) < 5
ORDER BY SUM(i.quantity) ASC
LIMIT 1;
```

**Flag:** `deadface{ConnectGear SafeDrive 2TB 16}`

---

## Phase 4 — C-Suite Payroll Impact

**Objective:** Calculate the total `pay_rate` for employees holding roles `CEO`, `CTO`, or `CFO`.

**Key table/columns:** `employees(pay_rate, role)`

**SQL:**
```sql
SELECT CONCAT('deadface{$', FORMAT(SUM(pay_rate), 2), '}') AS flag
FROM employees
WHERE role IN ('CEO','CTO','CFO');
```

**Flag:** `deadface{$7391.20}`

---

## Phase 5 — High Engagement & Top Spending Customers (Extras)

**High Engagement Customer** — likely determined by number of reviews or interactions; discovered flag:

**Flag:** `deadface{dgrimsley2ab@webs.com}`

**Top Spending Customer** — determined by aggregate orders/total spent; discovered flag:

**Flag:** `deadface{Willabella Wain}`

**IT Manager at Lowest-Average Facility** — an extra query revealed an IT manager contact and a numeric value:

**Flag:** `deadface{valera.kenner@epicsales.shop 2274.4626}`

---

## Phase 6 — b1tfr34k Identity (Negative Reviews Hint)

**Objective:** Using the hint that b1tfr34k *appears to harbor strong negative sentiments towards EpicSales*, search `reviews.comment` for negative content, link to `customers`, and extract the real name.

**Steps / SQL:**

1. Inspect all reviews to find negative comments:
```sql
SELECT review_id, customer_id, comment
FROM reviews;
```

2. Locate the negative review (in this dataset it was):
```
review_id = 4464
customer_id = 14644
comment = "FRAME RATES DIE UNDER PRESSURE LOADING TIMES ARE ETERNAL THIS THING IS A GLORIFIED PAPERWEIGHT. SYSTEM FREEZES EVERY TIME I LOAD A GAME WORST PERFORMANCE I HAVE EVER SEEN"
```

3. Lookup the customer record:
```sql
SELECT first_name, last_name
FROM customers
WHERE customer_id = 14644;
```

4. Or use a join to output the flag directly:
```sql
SELECT CONCAT('deadface{', c.first_name, ' ', c.last_name, '}') AS flag
FROM reviews r
JOIN customers c ON r.customer_id = c.customer_id
WHERE r.review_id = 4464;
```

**Flag:** `deadface{Billie Tournas}`

---

## All Flags (consolidated)

- Signups Flag: deadface{18}  
- Top Product Flag: deadface{VortexAudio Focus}  
- Low Stock Product Flag: deadface{ConnectGear SafeDrive 2TB 16}  
- C-Suite Payroll Flag: deadface{$7391.20}  
- High Engagement Customer Flag: deadface{dgrimsley2ab@webs.com}  
- Top Spending Customer Flag: deadface{Willabella Wain}  
- IT Manager at Lowest-Average Facility Flag: deadface{valera.kenner@epicsales.shop 2274.4626}  
- b1tfr34k Identity Flag: deadface{Billie Tournas}  


